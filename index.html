<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moradas Marília 1</title>
    <!-- Inclui o Tailwind CSS para estilização rápida e responsiva -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Define a fonte Inter para toda a página */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #374151;
        }

        /* Estilo para o modal de mensagem */
        .modal {
            display: none; /* Oculta o modal por padrão */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fff;
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            max-width: 32rem;
            width: 100%;
            position: relative;
        }
        
        .modal-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .loading-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-100 p-4 flex flex-col items-center">

    <!-- Cabeçalho principal com botões de navegação -->
    <header class="w-full max-w-4xl flex justify-between items-center py-4 px-6 bg-white rounded-xl shadow-lg mb-6">
        <h1 class="text-2xl font-bold text-gray-800">Moradas Marília 1</h1>
        <nav class="space-x-4">
            <button id="public-btn" class="px-4 py-2 rounded-lg font-medium transition-colors duration-300 bg-indigo-600 text-white shadow-md">
                Serviços
            </button>
            <button id="admin-btn" class="px-4 py-2 rounded-lg font-medium transition-colors duration-300 text-gray-600 hover:text-indigo-600">
                Administrador
            </button>
        </nav>
    </header>

    <!-- Container principal para o conteúdo dinâmico -->
    <div id="content" class="w-full max-w-4xl"></div>
    
    <!-- Modal para exibir mensagens geradas pela API -->
    <div id="message-modal" class="modal">
        <div class="modal-content">
            <h3 class="text-xl font-bold text-gray-800 mb-4">Mensagem Gerada ✨</h3>
            <p id="modal-text" class="text-gray-700 mb-4 whitespace-pre-wrap"></p>
            <div class="modal-buttons">
              <button id="copy-btn" class="flex-1 py-2 px-4 bg-indigo-600 text-white font-bold rounded-lg hover:bg-indigo-700 transition-colors duration-300">
                  Copiar Mensagem
              </button>
              <button id="close-btn" class="flex-1 py-2 px-4 bg-gray-200 text-gray-800 font-bold rounded-lg hover:bg-gray-300 transition-colors duration-300">
                  Fechar
              </button>
            </div>
        </div>
    </div>

    <!-- Modal de carregamento para a API -->
    <div id="loading-modal" class="loading-modal">
        <div class="bg-white p-6 rounded-lg shadow-lg">
            <p class="text-gray-700">Gerando mensagem...</p>
        </div>
    </div>
    
    <!-- Firebase SDKs -->
    <script type="module">
        // Importa as funções necessárias do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, deleteDoc, onSnapshot, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Configuração do Firebase
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "firebase/app";
        import { getAnalytics } from "firebase/analytics";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
        apiKey: "AIzaSyB4IoVrfzSu1UdjmWwl1tT8gwxa82c49fw",
        authDomain: "cmm1-cb564.firebaseapp.com",
        projectId: "cmm1-cb564",
        storageBucket: "cmm1-cb564.firebasestorage.app",
        messagingSenderId: "870845134975",
        appId: "1:870845134975:web:c24350b51643e40e56274a",
        measurementId: "G-XKWBH4DQ10"
    };

        // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

        // Variáveis de estado
        let providers = [];
        let view = 'public';
        let adminLoggedIn = false;
        let searchTerm = '';
        let form = { name: '', service: '', casa: '', contact: '' };

        // Referências aos elementos do DOM
        const contentDiv = document.getElementById('content');
        const publicBtn = document.getElementById('public-btn');
        const adminBtn = document.getElementById('admin-btn');
        const messageModal = document.getElementById('message-modal');
        const modalText = document.getElementById('modal-text');
        const copyBtn = document.getElementById('copy-btn');
        const closeBtn = document.getElementById('close-btn');
        const loadingModal = document.getElementById('loading-modal');

        // Autentica o usuário para poder usar o Firestore
        async function authenticate() {
            try {
                const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                if (initialAuthToken) {
                    const userCredential = await signInWithCustomToken(auth, initialAuthToken);
                    userId = userCredential.user.uid;
                    console.log("Autenticado com token personalizado:", userId);
                } else {
                    const userCredential = await signInAnonymously(auth);
                    userId = userCredential.user.uid;
                    console.log("Autenticado anonimamente:", userId);
                }
            } catch (error) {
                console.error("Erro na autenticação:", error);
                showModal("Falha na autenticação com o Firebase. Por favor, tente novamente.");
                userId = null;
            }
        }

        // Adiciona um listener para a coleção de fornecedores
        function listenForProviders() {
            if (!userId) {
                console.error("Erro: Usuário não autenticado para ouvir dados.");
                showModal("Erro: Você precisa estar autenticado para acessar os dados.");
                return;
            }

            if (!db) {
                console.error("Erro: Firestore não inicializado.");
                showModal("Erro: Falha ao conectar com o banco de dados.");
                return;
            }

            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
            const providersCollectionRef = collection(db, `artifacts/${appId}/users/${userId}/fornecedores`);
            onSnapshot(providersCollectionRef, (snapshot) => {
                const updatedProviders = [];
                snapshot.forEach(doc => {
                    updatedProviders.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                providers = updatedProviders;
                render();
            }, (error) => {
                console.error("Erro ao ouvir a coleção:", error);
                showModal("Erro ao carregar os fornecedores. Tente novamente.");
            });
        }

        // Função para adicionar um novo fornecedor ao Firestore
        async function addProviderToFirestore(newProvider) {
            if (!userId || !db) {
                console.error("Erro: Usuário não autenticado ou Firestore não inicializado.");
                showModal("Erro: Não foi possível adicionar o fornecedor. Tente novamente.");
                return;
            }
            try {
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                await addDoc(collection(db, `artifacts/${appId}/users/${userId}/fornecedores`), newProvider);
                form = { name: '', service: '', casa: '', contact: '' };
                showModal("Fornecedor adicionado com sucesso!");
                renderAdminPage();
            } catch (e) {
                console.error("Erro ao adicionar documento: ", e);
                showModal("Erro ao adicionar o fornecedor. Tente novamente.");
            }
        }

        // Função para remover um fornecedor do Firestore
        async function removeProviderFromFirestore(providerId) {
            if (!userId || !db) {
                console.error("Erro: Usuário não autenticado ou Firestore não inicializado.");
                showModal("Erro: Não foi possível remover o fornecedor. Tente novamente.");
                return;
            }
            try {
                const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                await deleteDoc(doc(db, `artifacts/${appId}/users/${userId}/fornecedores`, providerId));
                showModal("Fornecedor removido com sucesso!");
            } catch (e) {
                console.error("Erro ao remover documento: ", e);
                showModal("Erro ao remover o fornecedor. Tente novamente.");
            }
        }

        // Função principal para renderizar a página
        function render() {
            if (view === 'public') {
                renderPublicPage();
            } else {
                renderAdminPage();
            }
        }

        // Função para renderizar a página pública
        function renderPublicPage() {
            publicBtn.classList.add('bg-indigo-600', 'text-white', 'shadow-md');
            publicBtn.classList.remove('text-gray-600', 'hover:text-indigo-600');
            adminBtn.classList.remove('bg-indigo-600', 'text-white', 'shadow-md');
            adminBtn.classList.add('text-gray-600', 'hover:text-indigo-600');

            const filteredProviders = providers.filter(provider =>
                provider.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                provider.service.toLowerCase().includes(searchTerm.toLowerCase())
            );

            let publicHtml = `
                <main class="w-full max-w-4xl">
                    <h2 class="text-3xl font-bold text-gray-800 text-center mb-6">Serviços e Talentos dos Moradores</h2>
                    <div class="mb-6">
                        <input
                            type="text"
                            id="search-input"
                            placeholder="Buscar por nome ou serviço..."
                            value="${searchTerm}"
                            class="w-full p-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:border-indigo-500 transition-colors duration-300 shadow-sm"
                        />
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        ${filteredProviders.length > 0
                            ? filteredProviders.map(provider => `
                                <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow duration-300 flex flex-col justify-between">
                                    <div>
                                        <h3 class="text-xl font-semibold text-gray-800 mb-2">${provider.name}</h3>
                                        <p class="text-indigo-600 font-medium mb-3">${provider.service}</p>
                                        <div class="text-sm text-gray-600 mb-4">
                                            <p>Casa: <span class="font-semibold">${provider.casa}</span></p>
                                        </div>
                                    </div>
                                    <div class="flex flex-col space-y-2 mt-4">
                                        <button
                                            class="generate-message-btn w-full text-center bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-yellow-600 transition-colors duration-300"
                                            data-name="${provider.name}"
                                            data-service="${provider.service}"
                                        >
                                            ✨ Gerar Mensagem
                                        </button>
                                        <a
                                            href="https://wa.me/55${provider.contact.replace(/\D/g, '')}"
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            class="inline-block w-full text-center bg-green-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-600 transition-colors duration-300"
                                        >
                                            Entrar em Contato
                                        </a>
                                    </div>
                                </div>
                            `).join('')
                            : `<p class="col-span-full text-center text-gray-500">Nenhum serviço encontrado. Tente outra busca!</p>`
                        }
                    </div>
                    <div class="mt-8 text-center text-gray-500 text-sm">
                        <p>ID do App: <span class="font-mono text-gray-700">${typeof __app_id !== 'undefined' ? __app_id : 'default-app-id'}</span></p>
                        <p>ID do Usuário: <span class="font-mono text-gray-700">${userId || 'Não autenticado'}</span></p>
                    </div>
                </main>
            `;
            contentDiv.innerHTML = publicHtml;

            const searchInput = document.getElementById('search-input');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    searchTerm = e.target.value;
                    renderPublicPage();
                });
            }

            document.querySelectorAll('.generate-message-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const name = e.target.dataset.name;
                    const service = e.target.dataset.service;
                    generateContactMessage(name, service);
                });
            });
        }

        // Função para renderizar a página do administrador
        function renderAdminPage() {
            adminBtn.classList.add('bg-indigo-600', 'text-white', 'shadow-md');
            adminBtn.classList.remove('text-gray-600', 'hover:text-indigo-600');
            publicBtn.classList.remove('bg-indigo-600', 'text-white', 'shadow-md');
            publicBtn.classList.add('text-gray-600', 'hover:text-indigo-600');

            if (!adminLoggedIn) {
                contentDiv.innerHTML = `
                    <div class="w-full max-w-md p-8 bg-white rounded-xl shadow-lg">
                        <h2 class="text-2xl font-bold text-center text-gray-800 mb-6">Acesso Administrativo</h2>
                        <form id="admin-login-form" class="space-y-4">
                            <div class="flex flex-col">
                                <label for="username" class="text-gray-700 mb-1">E-mail</label>
                                <input type="email" id="username" name="username" required class="p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                            </div>
                            <div class="flex flex-col">
                                <label for="password" class="text-gray-700 mb-1">Senha</label>
                                <input type="password" id="password" name="password" required class="p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                            </div>
                            <p id="login-error-message" class="text-red-500 text-center hidden">E-mail ou senha inválidos.</p>
                            <button type="submit" class="w-full py-3 px-6 bg-indigo-600 text-white font-bold rounded-lg shadow-md hover:bg-indigo-700 transition-colors duration-300">
                                Entrar
                            </button>
                        </form>
                    </div>
                `;
                
                const loginForm = document.getElementById('admin-login-form');
                if (loginForm) {
                    const errorMessage = document.getElementById('login-error-message');
                    loginForm.addEventListener('submit', async (e) => {
                        e.preventDefault();
                        const email = e.target.username.value;
                        const password = e.target.password.value;
                        
                        try {
                            await signInWithEmailAndPassword(auth, email, password);
                            adminLoggedIn = true;
                            errorMessage.classList.add('hidden');
                            renderAdminPage();
                        } catch (error) {
                            console.error("Erro no login:", error);
                            errorMessage.classList.remove('hidden');
                            errorMessage.innerText = "E-mail ou senha inválidos.";
                        }
                    });
                }
            } else {
                let adminHtml = `
                    <main class="w-full max-w-4xl">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-3xl font-bold text-gray-800">Painel do Administrador</h2>
                            <button id="logout-btn" class="py-2 px-4 bg-red-500 text-white font-bold rounded-lg hover:bg-red-600 transition-colors duration-300">
                                Sair
                            </button>
                        </div>

                        <!-- Formulário para adicionar novo fornecedor -->
                        <div class="bg-white p-8 rounded-xl shadow-lg mb-6">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Adicionar Novo Fornecedor</h3>
                            <form id="add-provider-form" class="space-y-4">
                                <div class="flex flex-col">
                                    <label for="name" class="text-gray-700 mb-1">Nome</label>
                                    <input type="text" id="name" name="name" value="${form.name}" required class="p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                                </div>
                                <div class="flex flex-col">
                                    <label for="service" class="text-gray-700 mb-1 flex justify-between items-center">
                                        <span>Serviço</span>
                                        <button
                                            type="button"
                                            id="generate-description-btn"
                                            class="text-xs bg-purple-500 text-white rounded-full px-2 py-1 hover:bg-purple-600 transition-colors duration-300"
                                        >
                                            ✨ Gerar Descrição
                                        </button>
                                    </label>
                                    <textarea
                                        id="service"
                                        name="service"
                                        required
                                        class="p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 min-h-[100px]"
                                        rows="4"
                                    >${form.service}</textarea>
                                </div>
                                <div class="flex flex-col">
                                    <label for="casa" class="text-gray-700 mb-1">Casa</label>
                                    <input type="text" id="casa" name="casa" value="${form.casa}" required class="p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                                </div>
                                <div class="flex flex-col">
                                    <label for="contact" class="text-gray-700 mb-1">Contato (WhatsApp)</label>
                                    <input type="text" id="contact" name="contact" value="${form.contact}" required class="p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                                </div>
                                <button type="submit" id="submit-btn" class="w-full py-3 px-6 bg-indigo-600 text-white font-bold rounded-lg shadow-md hover:bg-indigo-700 transition-colors duration-300">
                                    Adicionar Fornecedor
                                </button>
                            </form>
                        </div>

                        <!-- Tabela de fornecedores existentes -->
                        <div class="bg-white p-8 rounded-xl shadow-lg">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Fornecedores Cadastrados</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full table-auto">
                                    <thead>
                                        <tr class="bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                            <th class="py-3 px-6 text-left">Nome</th>
                                            <th class="py-3 px-6 text-left">Serviço</th>
                                            <th class="py-3 px-6 text-left">Casa</th>
                                            <th class="py-3 px-6 text-left">Contato</th>
                                            <th class="py-3 px-6 text-center">Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody class="text-gray-600 text-sm font-light">
                                        ${providers.map(provider => `
                                            <tr class="border-b border-gray-200 hover:bg-gray-50">
                                                <td class="py-3 px-6 whitespace-nowrap">${provider.name}</td>
                                                <td class="py-3 px-6">${provider.service}</td>
                                                <td class="py-3 px-6">${provider.casa}</td>
                                                <td class="py-3 px-6">${provider.contact}</td>
                                                <td class="py-3 px-6 text-center space-x-2">
                                                    <button class="text-blue-500 hover:text-blue-700 font-bold transition-colors duration-300">Editar</button>
                                                    <button class="remove-btn text-red-500 hover:text-red-700 font-bold transition-colors duration-300" data-id="${provider.id}">
                                                        Remover
                                                    </button>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </main>
                `;
                contentDiv.innerHTML = adminHtml;

                const logoutBtn = document.getElementById('logout-btn');
                if (logoutBtn) {
                    logoutBtn.addEventListener('click', () => {
                        adminLoggedIn = false;
                        renderAdminPage();
                    });
                }
                
                const formElement = document.getElementById('add-provider-form');
                if (formElement) {
                    formElement.addEventListener('submit', (e) => {
                        e.preventDefault();
                        const newProvider = {
                            name: formElement.name.value,
                            service: formElement.service.value,
                            casa: formElement.casa.value,
                            contact: formElement.contact.value,
                        };
                        addProviderToFirestore(newProvider);
                    });
                }

                const generateDescBtn = document.getElementById('generate-description-btn');
                if (generateDescBtn) {
                    generateDescBtn.addEventListener('click', async () => {
                        const serviceInput = document.getElementById('service');
                        const serviceName = serviceInput.value;
                        const prompt = `Crie uma descrição de serviço curta e profissional para um fornecedor no condomínio. O serviço é: "${serviceName}". A descrição deve ser amigável e destacar o benefício para os moradores.`;
                        
                        loadingModal.style.display = 'flex';
                        try {
                            let chatHistory = [];
                            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                            const payload = { contents: chatHistory };
                            const apiKey = "SUA_CHAVE_API_GEMINI"; // Substitua pela chave real
                            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                            const response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });
                            const result = await response.json();
                            if (result.candidates && result.candidates.length > 0 &&
                                result.candidates[0].content && result.candidates[0].content.parts &&
                                result.candidates[0].content.parts.length > 0) {
                                const text = result.candidates[0].content.parts[0].text;
                                serviceInput.value = text.trim().replace(/^"|"$/g, '');
                            } else {
                                showModal("Não foi possível gerar a descrição. Tente novamente.");
                            }
                        } catch (error) {
                            console.error("Erro ao chamar a API Gemini:", error);
                            showModal("Erro ao gerar a descrição. Tente novamente.");
                        } finally {
                            loadingModal.style.display = 'none';
                        }
                    });
                }
                
                document.querySelectorAll('.remove-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const id = e.target.dataset.id;
                        if (window.confirm('Tem certeza que deseja remover este fornecedor?')) {
                            removeProviderFromFirestore(id);
                        }
                    });
                });
            }
        }
        
        // Função para gerar uma mensagem de contato usando a API Gemini
        async function generateContactMessage(name, service) {
            loadingModal.style.display = 'flex';
            try {
                const prompt = `Crie uma mensagem de rascunho curta e amigável para o WhatsApp para entrar em contato com um prestador de serviços. Inclua uma saudação, o nome do prestador e o serviço que ele oferece. O nome do prestador é "${name}" e o serviço é "${service}".`;
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = "SUA_CHAVE_API_GEMINI"; // Substitua pela chave real
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    showModal(text);
                } else {
                    showModal("Não foi possível gerar a mensagem. Por favor, tente novamente.");
                }
            } catch (error) {
                console.error("Erro ao chamar a API Gemini:", error);
                showModal("Erro ao gerar a mensagem. Por favor, tente novamente.");
            } finally {
                loadingModal.style.display = 'none';
            }
        }
        
        // Mostra o modal com a mensagem
        function showModal(message) {
            modalText.innerText = message;
            messageModal.style.display = 'flex';
        }

        // Lida com o evento de clique do botão Copiar
        copyBtn.addEventListener('click', () => {
            const textToCopy = modalText.innerText;
            try {
                const tempInput = document.createElement('textarea');
                tempInput.value = textToCopy;
                document.body.appendChild(tempInput);
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
                showModal("Mensagem copiada para a área de transferência!");
            } catch (err) {
                console.error("Falha ao copiar a mensagem: ", err);
                showModal("Não foi possível copiar a mensagem. Por favor, selecione e copie manualmente.");
            }
        });

        // Lida com o evento de clique do botão Fechar
        closeBtn.addEventListener('click', () => {
            messageModal.style.display = 'none';
        });

        // Event listeners para a navegação principal
        publicBtn.addEventListener('click', () => {
            view = 'public';
            render();
        });

        adminBtn.addEventListener('click', () => {
            view = 'admin';
            render();
        });

        // Inicia a aplicação: autentica e depois escuta as mudanças do Firestore
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                listenForProviders();
            } else {
                await authenticate();
            }
        });
    </script>
</body>
</html>
